---
id: learn-accounts
title: Polkadot 账户
sidebar_label: Polkadot 账户
description: 账户、账户索引、账户身份和回收机制的解释
---

本文档涵盖 Polkadot 和 Kusama 账户的基本地址及其在链上的保存。 欲了解更多关于加密技术背后的详细解释，请参阅 [加密页面](learn-cryptography)。

## 地址格式

基于 Substrate 的链的地址格式是SS58。SS58 是一种对于比特币的 Base-58-Check 进行小幅修改的格式。需要注意，此格式包含_地址类型_前缀，可以识别地址具体属于哪一个网络。

例如:

- Polkadot 地址总是以数字1开头。
- Kusama 地址总是以大写字母开头，如C、D、F、G、H、J...
- 通用Substrate 地址以5开头。

这些前缀在[此处](https://github.com/paritytech/substrate/wiki/External-Address-Format-(SS58))定义。

It's important to understand that the different formats for different networks are **merely different representations of the same public key in a private-public keypair** generated by an address generation tool. This makes the addresses compatible across Substrate-based chains as long as you convert the format.

> Many wallets allow you to convert between formats. Stand-alone tools exist as well, you can find them in the [address coversion tools](#address-conversion-tools) section.

## 地址的生成，派生和迁移

一个有效的账户只需要一个可以在[supported curves and signature scheme](build-protocol-info#cryptography)签名的私钥。多数钱包然间从助记词到生成账户需要经由许多步骤。同一组助记词，不同钱包采用不同步骤生成的账户也不会相同。

### 助记词(种子) 生成

Most wallets generate a mnemonic phrase for users to back up their wallets and generate a private key from the mnemonic. Not all wallets use the same algorithm to convert from mnemonic phrase to private key.

基于 Subkey 和 Polkadot-JS 的钱包采用BIP39词典来生成助记词，使用熵字节数组来生成私钥，这有别于其他 BIP39 钱包软件(如Ledger)采用 PBKDF2。所以，同一组助记词在经由这两种算法后并不能产生同样的私钥。更多相关细节请参阅[Substrate BIP39](https://github.com/paritytech/substrate-bip39)

### 衍生路径

许多 Polkadot 密钥生成工具支持硬派和软派生。更多关于派生路径的细节和例子请参考 [Subkey 文档](https://substrate. dev/docs/en/knowledgebase/integrate/subkey) 。Polkadot-JS 的应用和拓展同 Parity Signer 也支持采用和 Subkey 相同语法的自定义派生路径。

一些钱包会自动将派生路径添加到生成的助记词短语的末尾。这将为单独的路径生成单独的种子，从而允许使用相同的助记符，例如`<mnemonic phrase>//Polkadot` 和 `<mnemonic phrase>//Kusama`。尽管您可以正确保存助记词短语，但除非在两个钱包中使用相同的派生路径，否则在另一个钱包中使用它将不会生成相同的地址。

Polkadot 和 Kusama 都在[BIP44注册表](https://github.com/satoshilabs/slips/blob/master/slip-0044.md)中注册了路径。

> **Warning:** You must have both the parent private key as well as the derivation path to arrive at the key for an address. Do not use custom derivation paths unless you are comfortable with your understanding of this topic.

### 可移植性

以上信息为我们带来了可移植性：在多个钱包中使用助记词或种子的能力。可移植性取决于许多因素：

- 派生路径
- 助记符格式
- 种子衍生
- 签名方案

如果要在多个钱包中使用相同的助记符，请确保它们遵循兼容生成密钥和签名消息的方法。如果找不到可理解的文档，请与项目维护人员联系。

|                  | 助记符格式  |     派生路径      |     种子衍生      |            签名支持             |
|:---------------- |:------:|:-------------:|:-------------:|:---------------------------:|
| Polkadot{.js} 扩展 |   标准   |     用户自定义     |     BIP32     |           sr25519           |
| Polkadot-JS 应用程序 | 标准\* |     用户自定义     |     BIP32     | sr25519, ed25519, secp256k  |
| 账本               | BIP39  | BIP44&dagger; | BIP32&Dagger; |        ed25519&sect;        |
| Subkey           | 标准\* |     用户自定义     |     BIP32     | sr25519, ed25519, secp256k1 |

\ * 附带 BIP39 的 Ed25519 密钥具有[有限的兼容性](https://github.com/paritytech/substrate-bip39)。

&dagger; [BIP44 注册表](https://github.com/satoshilabs/slips/blob/master/slip-0044.md)

&Dagger; 基于[Khovratovich](https://github.com/LedgerHQ/orakolo/blob/master/papers/Ed25519_BIP%20Final.pdf)的 Ed25519 和 BIP32

&sect; Sr25519 计划

### 好奇：前缀的工作原理

这是[ SS58 文档](https://github.com/paritytech/substrate/wiki/External-Address-Format-(SS58))的申明：

- Polkadot 的地址类型为`000000000`，所以`0`是十进制。
- Kusama (Polkadot 金丝雀) 的地址类型为`00000010b`，因此`2`以十进制表示。
- 通用 Substrate 的地址类型为`00101010b`，十进制为`42`。

因为 Base58-check 字母没有数字0，所以最小值确实是1。因此，`00000000b`在 Base58 中是1。如果我们尝试[解码](https://www.better-converter.com/Encoders-Decoders/Base58Check-to-Hexadecimal-Decoder)诸如` 1FRMM8PEiWXYax7rpS6X4XZX1aAAxSWx1CrKTyrVYhV24fg `的Polkadot地址，则结果为` 000aff6865635ae11013a83835c019d44ec3f865145943f487ae82a8b7e7bed`。第一个字节是`00`，实际上既是二进制的`00000000`又是十进制的`0`，因此它与 Polkadot 的地址类型匹配。

让我们看一下 Substrate 的地址。如果我们解码` 5CK8D1sKNwF473wbuBP6NuhQfPaWUetNsWUNAAzVwTfxqjfr`，则会得到` 2a0aff6865635ae11013a83835c019d44ec3f865145943f487ae82a8e7bed3a66b77e5`。第一个字节是`2a`，当[从十六进制转换为十进制](https://www.rapidtables.com/convert/number/hex-to-decimal.html)时是42。42的二进制是`00101010`，就像 SS58 文档所述的那样。

最后，让我们看一下 Kusama 的地址。解码` CpjsLDC1JFyrhm3ftC9Gs4QoyrkHKhZKtK7YqGTRFtTafgp`会让我们得到` 020aff6865635ae11013a83835c019d44ec3f865145943f487ae82a8e7bed3a66b0985`，正如被指定的那样，其中第一个字节为`02`。如果我们尝试以完全不同的字母，例如` J4iggBtsWsb61RemU2TDWDXTNHqHNfBSAkGvVZBtn1AJV1a`，我们仍然将`02`作为第一个字节：` 02f2d606a67f58fa0b3ad2b556195a0ef905676efd4e2114`。从直觉上看，有些地址总是有相同的前缀，而其他一些地址像是用 Kusama 生成的却可能千差万别，但这只是对于 Base58-check 编码的怪癖。

## 获取和管理地址

The **most user-friendly** way to create a Polkadot or Kusama address is through the [Polkadot-JS UI](https://polkadot.js.org/apps/#/accounts). Remember to back up the seed phrase used to generate your account - the accounts are stored only in your browser, so purging the cache will wipe your accounts as well. You would then have to recreate them using the seed phrase given to you by the UI - this will also restore all your previously held balances.

**更方便和推荐**的将帐户保存在计算机上方法是使用[ Polkadot {.js}扩展名](https://github.com/polkadot-js/extension)。此扩展程序可以记住您的帐户，让您不必担心即可清除浏览器缓存。不过，不要忘记备份您的种子短语 - 如果您无法使用这台计算机，或者扩展名以某种方式崩溃而无法修复，则该短语将派上用场。

请注意，由于这会将您的帐户保留在浏览器中，因此这里不是一个存放大量资产的安全之地。根据定义，浏览器是一个“热钱包”，容易受到各种各样的攻击，因此，在处理不重要的数额时，请将资金保存在冷库中。为了提高安全性，您可以安全地隐藏帐户的种子短语，并在创建帐户后从计算机中删除所有帐户痕迹。

除了扩展名和默认UI外，还可以使用[ 子键工具](https://github.com/paritytech/substrate/tree/master/bin/utils/subkey)。子键旨在供用户熟悉使用命令行使用，并且看起来令人生畏，但相当平易近人。请按照[子键文档](https://substrate.dev/docs/en/knowledgebase/integrate/subkey)。如果使用得当，子键是创建帐户的**最安全**的可用方法。

还有一个非常安全的[奇偶校验签名人](https://www.parity.io/signer/)。这样可以将您的钥匙保持在气密的手机上。但是，这确实需要获得您常用的且仅用于 Parity Signer 的旧 Android 或 iOS 兼容手机。

账本可以与硬件钱包集成。完整指南可在[此处](learn-ledger)获得。

另外，您可能会在[钱包](build-wallets)页面上找到其他钱包，但请记住，其中一些是**未经审计的**，除非另有说明，否则它们并不隶属于Web3 Foundation或Polkadot的正式项目。

## 余额类型

在 Polkadot 上，有四种不同的余额类型，提示您的余额是否可以用于转账，支付费用，或者由于链上要求而必须冻结且不被使用。

余额类型由 Substrate 中的`AccountData`结构定义。四种类型的余额包括`free`，`reserved`，`misc_frozen` (驼峰体为`miscFrozen`) 和` fee_frozen` (驼峰体为`feeFrozen`)。

通常，帐户的**可用**余额是`自由`的金额减去任何被视为冻结的资金 (`misc_frozen`或`free_frozen`) ，具体取决于使用资金的原因。如果资金将用于转账，则可用金额为“自由”金额减去任何`misc_frozen`资金。但是，如果要使用这些资金来支付交易费用，则可用金额将是“自由”资金减去`fee_frozen `的任何资金。

帐户的“总”余额被认为是帐户中“自由”资金的数量减去任何“保留”的资金。保留的资金是根据链上的要求持有的，通常可以通过执行一些链上操作来释放。例如，“身份”模块在注册链上身份时保留资金，但是通过清除身份，您可以取消保留资金并再次释放它们。

## 现有存款和回收

生成帐户 (地址) 时，仅生成一个_密钥_，您可以使用该密钥进行访问。该帐户尚不存在，为此，它需要0.001666666667个KSM(在kusama上) 或1个DOT(在Polkadot主网上) 使其被生成。

如果帐户低于现有存款，则会导致该帐户_被回收_。该帐户以及该地址中的所有资金将从区块链状态中删除，以节省空间。您不会失去对回收地址的访问权限 - 只要您拥有私钥或恢复短语，您仍然可以使用该地址 - 但它需要充值额外的存续金额才能与链进行交互。

这是考虑存量的另一种方法。您是否曾经注意到Windows上的`Thumbs.db `文件或Mac上的`.DS_Store`文件？这些都是垃圾邮件，除了使预览速度更快之外，它们没有其他目的。如果保存该文件的文件夹是完全空的，则可以删除该文件夹以清除硬盘驱动器上的垃圾。这并不意味着您将永远失去对该文件夹的访问权限 - 您可以随时重新创建该文件夹。毕竟，您拥有_密钥_ - 您是计算机的所有者。这只是意味着您要保持计算机清洁，直到您可能再次需要此文件夹，然后重新创建它为止。您的地址就像这个文件夹 - 当其中没有任何内容时，会将其从链中删除，但当它至少具有使账户存续的资金时，它将被释放。

## 索引

Kusama 或 Polkadot 地址可以具有索引。索引就像一个简短易记版本的地址。索取索引需要保证金，当索引清除时保证金得到释放。

索引是按顺序填充的。可以将它们视为从0到任意数字的插槽：

`[0][1][2][3][4][5][6]...`

如果插槽0-2分别由地址A，B和C填充，并且我在地址X上添加了一个存续资金，那么该地址将自动放入插槽3。此后，您可以通过发送至`[3]`而不是记住我的完整地址。

```js
[0][1][2][3][4][5][6]...
[A][B][C][X][ ][ ][ ]...
```

但是，如果如上所述获得了帐户怎么办？在这种情况下，索引将被清空。换句话说，插槽再次释放。如果有人创建了一个新帐户，则他们可能最终会使用另一个地址曾经用过的相同的索引。

可以_冻结_一个索引并将其永久分配给一个地址。此操作会消耗一笔保证金，但要确保除非持有帐户释放该索引，否则永不收回该索引。

要注册索引，请将外部的`申明`提交给`索引`模块，然后从外部进行`冻结`。最简单的方法是通过_Developer-> 的PolkadotJS UI。外部_菜单：

![外部索引](assets/accounts/index.png)

要查找可用的索引， [此帮助器工具可能会派上用场](https://www.shawntabrizi.com/substrate-js-utilities/indices/)。

## 身份

The [_Identities pallet_](https://github.com/paritytech/substrate/tree/master/frame/identity) built into Polkadot allows users to attach on-chain metadata to their accounts. This metadata can be verified by independent registrars to provide trustworthiness. To learn more about how to set or release an identity, how to define sub-accounts, or how to become a registrar, please read [this guide](learn-identity).

## 代理账户

Polkadot 带有通用的代理帐户系统，该系统允许用户将密钥保留在冷存储中，而代理则使用受限制的 (或不受限制的) 功能代表他们。更多相关信息，请参见[代理](learn-proxies)页面。

## 多签名账户

可以在基于 Substrate 的链中创建一个多重签名帐户。多重签名帐户由一个或多个地址和一个阈值组成。阈值定义了需要多少签名者 (参与地址) 同意外部提交才能成功进行呼叫。

例如，爱丽丝 (Alice)，鲍勃 (Bob) 和查理 (Charlie) 设置了一个阈值为2的多重信号。这意味着即使查理 (Charlie) 不同意，爱丽丝 (Alice) 和鲍勃 (Bob) 也可以执行任何呼叫。同样，查理 (Charlie) 和鲍勃 (Bob) 可以在没有爱丽丝 (Alice) 的情况下执行任何呼叫。阈值通常小于成员总数，但也可以等于成员总数，这意味着它们必须完全一致。

> Learn more about multisig accounts from our [technical explainer video](https://www.youtube.com/watch?v=ZJLqszvhMyM&list=PLOyWqupZ-WGuAuS00rK-pebTMAOxW41W8&index=25&ab_channel=Polkadot).

多签名账户有以下用途：

- 保护您自己的藏匿处：使用其他签署人作为2FA机制来保护您的资金。一个签名者可以在一台计算机上，另一个可以在另一台计算机上，或在冷库中。这减慢了您与链的交互速度，但是安全性提高了几个数量级。
- 董事会决策：诸如企业和基金会之类的法人实体使用多重签名来共同管理实体的国库。
- 团体参与治理：多签名帐户可以执行常规帐户可以执行的所有操作。具有多重签名的帐户可以是 Kusama 治理中的理事​​会成员，在该理事会中，一组社区成员可以作为一个实体进行投票。

多签名帐户**创建后无法修改**。不可能更改成员集或更改阈值，而是需要解散当前的多重签名并创建一个新信号。因此，多签名帐户的地址是**确定的**，即您始终可以通过知道成员和阈值来计算多签名的地址，而无需使用该帐户。这意味着可以将令牌发送到尚不存在的地址，并且如果指定为接收方的实体在匹配的阈值下以新的多重签名形式出现，则它们将立即能够访问这些令牌。

### 生成多重签名帐户的地址

> NOTE: Addresses that are provided to the multi-sig wallets must be sorted. The below methods for generating sort the accounts for you, but if you are implementing your own sorting then be aware that the public keys are compared byte-for-byte and sorted ascending before being inserted in the payload that is hashed.

地址是根据多重签名钱包的签名者和阈值来确定生成的。对于生成的代码示例 (在TypeScript 中) 可以查看`@w3f/msig-util`[此处](https://github.com/lsaether/msig-util/blob/master/src/actions/deriveAddress.ts)。

`@w3f/msig-util`是一个小型的CLI工具，可以根据您的输入确定多重签名地址。

```zsh
$ npx @w3f/msig-util@1.0.7 derive --addresses 15o5762QE4UPrUaYcM83HERK7Wzbmgcsxa93NJjkHGH1unvr,1TMxLj56NtRg3scE7rRo8H9GZJMFXdsJk1GyxCuTRAxTTzU --threshold 1
npx: installed 79 in 7.764s
--------------------------------
Addresses: 15o5762QE4UPrUaYcM83HERK7Wzbmgcsxa93NJjkHGH1unvr 1TMxLj56NtRg3scE7rRo8H9GZJMFXdsJk1GyxCuTRAxTTzU
Threshold: 1
Multisig Address (SS58: 0): 15FKUKXC6kwaXxJ1tXNywmFy4ZY6FoDFCnU3fMbibFdeqwGw
--------------------------------
```

如[帐户生成”页面](learn-account-generation#multi-signature-accounts)中所述，Polkadot-JS Apps UI也支持多签名帐户。这比手动生成它们容易。

### 使用多重签名帐户进行交易

多重签名帐户可以执行三种类型的操作：

- 执行一笔交易
- 授权一笔交易
- 撤销一笔交易

在仅需要一次批准的情况下，应使用便捷方法`as_multi_threshold_1`。此函数仅将其他签名者和原始调用作为其参数。

但是，除了简单的一次批准情况以外，您可能需要的不止一种签名者在最终执行交易之前批准该交易。当您创建一笔新交易或授权一笔交易作为多签名，您需要存入少量保证金。存款将保持锁定在托盘中，直到执行交易为止。需要存款的原因是多重签名调用占用链上存储空间付出了经济成本，并阻止用户创建从未执行的悬空多重签名操作。押金将保留在呼叫者的帐户中，因此多签名钱包的参与者应准备可用的备用资金。

保证金取决于`threshold`参数，其计算方法如下：

```
存款=存款基数+阈值*存款因子
```

其中，`存款基数`和`DepositFactor`是在运行时代码中设置的链常量。

当前，存款基数等于`存款(1,88)`，而存款因子等于`存款(0,32)`。

JavaScript 的存款功能定义如下，来自[Rust资源](https://github.com/paritytech/polkadot/blob/master/runtime/kusama/src/constants.rs#L26)。

```js
// Polkadot
const DOLLARS = 10000000000; // planck
const MILLICENTS = 100000; // planck

// Kusama
// const DOLLARS = 166666666666.67;
// const MILLICENTS = 1666666.66;

const deposit = (items, bytes) => {
  return items * 20 * DOLLARS + bytes * 100 * MILLICENTS;
};

console.log("DepositBase", deposit(1, 88));
console.log("DepositFactor", deposit(0, 32));
```

因此，可以如下表所示计算存款值。

|      | Polkadot     | Kusama          |
| ---- | ------------ | --------------- |
| 存款基数 | 200880000000 | 3347999999941.4 |
| 存款因子 | 320000000    | 5333333312      |

让我们构想一个在 Polkadot 上进行多重签名的例子，该签名的阈值为2个和3个签名者：Alice(爱丽丝)，Bob(鲍勃) 和Charlie(查理)。 首先爱丽丝(Alice) 将通过使用原始调用`as_multi`来创建链上交易。这样做时，爱丽丝(Alice) 在等待鲍勃(Bob) 或查理(Charlie) 也授权交易时必须存入0.20152 DOT。当鲍勃(Bob) 批准交易并执行交易时，他将不需要存入保证金，而爱丽丝(Alice) 将收回她的保证金。

## Address Conversion Tools

You can use the tool below to convert any SS58 address for any network for use on different networks.

<div class="address-changer">
  <input class="address-changer-input" id="input" placeholder="贴下你的地址" oninput="globalThis.addressChanger()" />
  <select class="address-changer-select" id="prefix-select" oninput="globalThis.addressChanger()">
    <option value="0">Polkadot</option>
    <option value="2">Kusama</option>
    <option value="5">Plasm</option>
    <option value="10">Acala</option>
    <option value="16">Kulupu</option>
    <option value="28">Subsocial</option>
    <option value="36">Centrifuge</option>
    <option value="42">Substrate</option>
  </select>
  <span class="address-changer-output" id="output" />
</div>

Alternatively, use [this handy subscan tool](https://polkadot.subscan.io/tools/ss58_transform).

## 资源

- [了解 Polkadot 中的帐户和密钥](https://www.crowdcast.io/e/polkadot-keys)-解释了 Polkadot 中不同类型的帐户和密钥的用途，与 BlockX Labs 的 Bill Laboon 和 Chinmay Patel 合作。
